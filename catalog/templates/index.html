{% extends "catalog.html" %}
{% load static %}
{% load flavor_grid_view %}
{% block headers %}
<script type="text/javascript">
        if (!window['YT']){
            var YT = {loading: 0,loaded: 0};
        }
        if (!window['YTConfig']){
            var YTConfig = {'host': 'https://www.youtube.com'};
        }
        if (!YT.loading) {
            YT.loading = 1;
            (function(){
                var l = [];
                YT.ready = function(f){
                    if (YT.loaded) {
                        f();
                    }else {
                        l.push(f);
                    }
                };
                window.onYTReady = function() {
                    YT.loaded = 1;
                    for (var i = 0; i < l.length; i++) {
                        try {
                                l[i]();
                            } catch (e) {}
                    }
                };
                YT.setConfig = function(c) {
                    for (var k in c) {
                        if (c.hasOwnProperty(k)) {
                            YTConfig[k] = c[k];
                        }
                    }
                };
                var a = document.createElement('script');
                a.type = 'text/javascript';
                a.id = 'www-widgetapi-script';
                a.src = 'https://s.ytimg.com/yts/jsbin/www-widgetapi-vfliWHxmV/www-widgetapi.js';
                a.async = true;
                var b = document.getElementsByTagName('script')[0];b.parentNode.insertBefore(a, b);
            })();
        }
</script>

{% endblock %}
{% block site_main %}
<!--Video Section-->
<!--<section class="content-section video-section">-->
    <!--<div class="pattern-overlay">-->
        <!--<a id="bgndVideo" class="player" data-property="{videoURL:'https://www.youtube.com/watch?v=3LTJXcvz2ro',containment:'.video-section', quality:'large', autoPlay:true, mute:true, opacity:1}">bg</a>-->
        <!--<div class="container">-->
            <!--<div class="row">-->
                <!--<div class="col-lg-12">-->
                <!--</div>-->
            <!--</div>-->
        <!--</div>-->
    <!--</div>-->
<!--</section>-->
<section>
        <div class="cover">
          <div class="hi"></div>
        </div>
        <div class="tv">
              <div class="screen mute" id="tv"></div>
        </div>
</section>
<!--Video Section Ends Here-->
<section>
    <div class="container">
        <div class="policy-wrapper border-bottom">
            <div class="row">
            	{% for x in policies %}
                <div class="col-md-4 col-sm-4 col-xs-8">
                    <div class="policy">
                        <div class="policy-icon">
                            <img src="{{ x.get_image_url }}" />
                        </div>
                        <div class="policy-text" style="text-align:center;padding-top: 15px">
                            <h4>{{ x.name }}</h4>
                            <p>{{ x.description|default_if_none:"" }}</p>
                        </div>						
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>
</section>

<section>
    <div class="container">
        {% if request.volumes_data|length > 3 %}
        <div class="padding-vertical-50 border-bottom">
            <div class = "arrivals">
                <div class="section-header center">
                    <h2 class="upper margin-bottom-20">SHOP</h2>
                    <p>Size Does Matter</p>
                </div><!-- ./section-header -->
                <div class="products home-products owl-carousel" data-items="4">
                    {% for key,value in request.volumes_data.items %}
                        <div class="awe-media">
                            <div class="awe-media-image">
                                <a href="{% url 'catalog:volume' id=key view='form'  %}" title="{{ value.name }}">
                                    {% if value.category_url %}
                                        <img src="{{ value.category_url }}" alt="">
                                    {% else %}
                                        <img src="{% static 'img/270x200.jpg' %}" alt="">
                                    {% endif %}
                                </a>
                            </div><!-- /.awe-media-image -->

                            <div class="awe-media-body center margin-vertical-20">
                                <a href="{% url 'catalog:volume' id=key view='form'  %}" title="{{value.name}}">{{value.name}}</a>
                            </div><!-- /.awe-media-body -->
                        </div><!-- /.awe-media -->
                    {% endfor %}
                </div><!-- /.products -->
            </div>
        </div>
        {% else %}
        <div class="home-products padding-vertical-60">
            <div class="row">
                <div class="col-md-3 col-sm-4">
                    <div class="awe-media home-cate-media">
                        <div class="awe-media-header">
                            <div class="awe-media-image">
                                <img src="{% static  'img/shop.jpg' %}" alt="">
                            </div><!-- /.awe-media-image -->
                            <div class="awe-media-overlay overlay-dark-50 fullpage">
                                <div class="content">

                                    <div class="fp-table text-left">
                                        <div class="fp-table-cell">

                                            <h2 class="upper">SHOP</h2>
                                            <p class="margin-bottom-50">Size Does Matter</p>
                                        </div>
                                    </div>

                                </div>
                            </div><!-- /.awe-media-overlay -->

                        </div><!-- /.awe-media-header -->
                    </div><!-- /.awe-media -->
                </div>
                <div class="col-md-9 col-sm-8">
                    <div class="products owl-carousel" data-items="{{ request.volumes_data|length }}">
                        {% for key,value in request.volumes_data.items %}
                            <div class="product product-grid">
                                <div class="product-media">
                                    <div class="product-thumbnail">
                                        <a href="{% url 'catalog:volume' id=key view='form'  %}" title="">
                                            {% if value.category_url %}
                                                <img src="{{ value.category_url }}" alt="" class = "current">
                                            {% else %}
                                                <img src="{% static 'img/270x200.jpg' %}" class = "current" alt="">
                                            {% endif %}
                                        </a>
                                    </div><!-- /.product-thumbnail -->
                                    <div class="product-body">
                                        <h2 class="product-name">
                                            <a href="{% url 'catalog:volume' id=key view='form'  %}" title="{{value.name}}">{{value.name}}</a>
                                        </h2><!-- /.product-product -->
                                    </div><!-- /.product-body -->
                                </div><!-- /.awe-media -->
                            </div>
                        {% endfor %}
                    </div><!-- ./products -->
                </div>
            </div>
        </div>
        {% endif %}
    </div><!-- /.container -->
</section><!-- /section -->

<section>
    <div class="container">
        <div class="padding-vertical-50 border-bottom">
            <div class="section-header center">
                <h2>FEATURED JJUICE BLENDS</h2>
            </div><!-- /.section-header -->

            <div class="products home-products owl-carousel" data-items="4">
                
                    {% for line in lines_list %}
                        {# Django provides it you can use {{ forloop.counter }} index start at 1 or {{ forloop.counter0 }} index start at 0. #}
                        {% flavor_grid_view line.0 line.1 '/' %}
                    {% endfor %}
                
            </div><!-- /.products -->
        </div><!-- /.padding-vertical-50 -->
    </div><!-- /.container -->
</section><!-- /section -->

<section class="background background-color-dark background-image-section-customers-say" style="background-image: url({{ customerreview_banner_url }}) !important;">
    <div class="container" >
        <div class="padding-top-60">
            <div class="section-header center">
                <h2>Customer Say</h2>
            </div><!-- /.section-header -->

            <div class="section-customers">
                <div class="row">
                    <div class="col-md-8 col-md-offset-2">
                        <div class="customers-carousel owl-carousel"  id="customers-carousel" data-toggle="carousel" data-dots="true" data-nav="0">
                            {% for review in reviews %}
                            <div class="center">
                                <h4>{{ review.partner_id.name }}</h4>
                                <p>“{{ review.review }}“</p>
                            </div><!-- /.center -->
                            {% endfor %}
                        </div><!-- /.customers-say-carousel -->
                    </div>
                </div>
            </div><!-- /.section-content -->
        </div>
    </div><!-- /.container -->

    <div class="section-brands">
        <div class="container">
            <div class="brands-carousel owl-carousel" data-items="{{ reviews|length }}" id="brands-carousel">
                {% for review in reviews %}
                <div class = "center" >
                    {% if review.partner_id.image %}
                        <img src="data:image/jpg;base64,{{ review.partner_id.image }}" alt="" style="height:80px;width:90px;">
                        
                    {% else %}                        
                        <img src="{% static 'img/samples/brands/brand-1.png' %}" style="height:80px;width:90px;" alt="">
                    {% endif %}
                </div>
                {% endfor %}
            </div><!-- /.brands-carousel -->
        </div><!-- /.container -->
    </div><!-- /.section-brands -->

</section><!-- /section --> 

<section>
    <div class="container">
        <div class="margin-bottom-50 margin-top-50">
            <div class="subscible-wrapper subscible-inline">
                <div class="row">
                    <div class="col-md-2">
                        <h3 class="subscribe-title">Subscribe newsletter</h3>
                    </div>

                    <div class="col-md-4">
                        <div class="subscribe-comment">
                            <p>Subscripte to our newsletter to get the updated from upcoming flavors</p>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <form method="GET" action="{% url 'misc:newsletter' %}" class="subscible-form">
                            {% csrf_token %}    
                            <div class="form-group">
                                <label class="sr-only" for="subscribe-email">Email</label>
                                <input type="email" name="email"  required placeholder="Enter your email address" class="form-control" id="subscribe-email">
                            </div>

                            <div class="form-submit">
                                <button class="btn btn-lg btn-primary" type="submit">Subscribe email</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div><!-- /.subscible-wrapper -->
        </div>
    </div><!-- /.container -->
</section><!-- /section -->
{% endblock %}
{% block load_javascript %}
require(['underscore'],function(_){
    $(document).ready(function () {
        var tv,
        playerDefaults = {autoplay: 1, autohide: 1, modestbranding: 0, rel: 0, showinfo: 0, controls: 0, disablekb: 1, enablejsapi: 0, iv_load_policy: 3};
        var vid = [
                    {'videoId': '3LTJXcvz2ro', 'startSeconds': 0, 'endSeconds': 72, 'suggestedQuality': 'hd720'},
                ],
        randomVid = Math.floor(Math.random() * vid.length),
        currVid = randomVid;
        function onYouTubePlayerAPIReady(){
          tv = new YT.Player('tv', {events: {'onReady': onPlayerReady, 'onStateChange': onPlayerStateChange}, playerVars: playerDefaults});
        }
        function onPlayerReady(){
          tv.loadVideoById(vid[currVid]);
          tv.mute();
        }
        function onPlayerStateChange(e) {
          if (e.data === 1){
            $('#tv').addClass('active');
            $('.hi em:nth-of-type(2)').html(currVid + 1);
          } else if (e.data === 2){
            $('#tv').removeClass('active');
            if(currVid === vid.length - 1){
              currVid = 0;
            } else {
              currVid++;
            }
            tv.loadVideoById(vid[currVid]);
            tv.seekTo(vid[currVid].startSeconds);
          }
        }

        function vidRescale(){
          var w = $(window).width()+200,
            h = $(window).height()+200;

          if (w/h > 16/9){
            tv.setSize(w, w/16*9);
            $('.tv .screen').css({'left': '0px'});
          } else {
            tv.setSize(h/9*16, h);
            $('.tv .screen').css({'left': -($('.tv .screen').outerWidth()-w)/2});
          }
        }
        $(window).on('load resize', function(){
          vidRescale();
        });
        onYouTubePlayerAPIReady();
    }) // document.ready
}) // require

//    require(['YTPlayer'],function(){
//        $(document).ready(function () {
//            $(".player").mb_YTPlayer();
//        });
//    })
{% endblock %}
